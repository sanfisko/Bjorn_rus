# Команды для диагностики проблем Bjorn

## 1. Проверка полных логов сервиса
```bash
# Показать последние 50 строк логов без ограничений
sudo journalctl -u bjorn.service -n 50 --no-pager

# Показать логи в реальном времени
sudo journalctl -u bjorn.service -f

# Показать логи с определенного времени
sudo journalctl -u bjorn.service --since "10 minutes ago"
```

## 2. Анализ файловых дескрипторов
```bash
# Показать все открытые файлы процесса Bjorn
sudo lsof -p 343

# Подсчет дескрипторов по типам
sudo lsof -p 343 | awk '{print $5}' | sort | uniq -c | sort -nr

# Проверка лимитов процесса
cat /proc/343/limits
```

## 3. Мониторинг ресурсов
```bash
# Использование памяти процессом
ps aux | grep python3 | grep Bjorn

# Детальная информация о процессе
sudo cat /proc/343/status

# Проверка сетевых соединений
sudo netstat -tulpn | grep 343
```

## 4. Проверка логов приложения
```bash
# Логи Bjorn (если есть)
tail -f /home/bjorn/Bjorn_rus/data/logs/*.log

# Проверка временных файлов
ls -la /home/bjorn/Bjorn_rus/data/logs/
```

## 5. Анализ производительности
```bash
# Топ процессов по использованию ресурсов
top -p 343

# Детальная статистика I/O
sudo iotop -p 343

# Системные вызовы (осторожно - много вывода)
sudo strace -p 343 -c
```

## Возможные причины проблем:

1. **Утечка файловых дескрипторов** - не закрываются сетевые соединения или файлы
2. **Проблемы с дисплеем** - возможно, проблемы с EPD дисплеем
3. **Сетевое сканирование** - много открытых соединений для сканирования
4. **Логирование** - проблемы с записью в лог-файлы

## Рекомендуемые действия:

1. Сначала выполните команды из раздела 1 и 2
2. Если количество дескрипторов растет - есть утечка
3. Проверьте логи приложения на ошибки
4. При необходимости перезапустите сервис: `sudo systemctl restart bjorn.service`